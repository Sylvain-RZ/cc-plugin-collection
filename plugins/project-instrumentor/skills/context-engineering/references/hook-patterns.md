# Common Hook Patterns

Reusable hook configurations for common automation needs.

## Code Formatting Hooks

### Multi-Language Formatter

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write(*.ts)|Write(*.tsx)|Write(*.js)|Write(*.jsx)|Edit(*.ts)|Edit(*.tsx)|Edit(*.js)|Edit(*.jsx)",
        "hooks": [{
          "type": "command",
          "command": "prettier --write \"$CLAUDE_FILE_PATHS\""
        }]
      },
      {
        "matcher": "Write(*.py)|Edit(*.py)",
        "hooks": [{
          "type": "command",
          "command": "black \"$CLAUDE_FILE_PATHS\""
        }]
      },
      {
        "matcher": "Write(*.go)|Edit(*.go)",
        "hooks": [{
          "type": "command",
          "command": "gofmt -w \"$CLAUDE_FILE_PATHS\""
        }]
      },
      {
        "matcher": "Write(*.rs)|Edit(*.rs)",
        "hooks": [{
          "type": "command",
          "command": "rustfmt \"$CLAUDE_FILE_PATHS\""
        }]
      },
      {
        "matcher": "Write(*.json)|Edit(*.json)",
        "hooks": [{
          "type": "command",
          "command": "prettier --write \"$CLAUDE_FILE_PATHS\""
        }]
      },
      {
        "matcher": "Write(*.md)|Edit(*.md)",
        "hooks": [{
          "type": "command",
          "command": "prettier --write \"$CLAUDE_FILE_PATHS\""
        }]
      }
    ]
  }
}
```

### Format + Lint Chain

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write(*.ts)|Write(*.tsx)|Edit(*.ts)|Edit(*.tsx)",
        "hooks": [
          {
            "type": "command",
            "command": "prettier --write \"$CLAUDE_FILE_PATHS\""
          },
          {
            "type": "command",
            "command": "eslint --fix \"$CLAUDE_FILE_PATHS\""
          }
        ]
      }
    ]
  }
}
```

### Python Quality Chain

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write(*.py)|Edit(*.py)",
        "hooks": [
          {
            "type": "command",
            "command": "black \"$CLAUDE_FILE_PATHS\""
          },
          {
            "type": "command",
            "command": "isort \"$CLAUDE_FILE_PATHS\""
          },
          {
            "type": "command",
            "command": "ruff check --fix \"$CLAUDE_FILE_PATHS\""
          }
        ]
      }
    ]
  }
}
```

## Protection Hooks

### Prevent Env File Modifications

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write(*.env*)|Edit(*.env*)",
        "hooks": [{
          "type": "command",
          "command": "echo 'ERROR: Cannot modify environment files directly. Edit .env.example instead.' && exit 1"
        }]
      }
    ]
  }
}
```

### Protect Production Config

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write(**/prod/**)|Edit(**/prod/**)|Write(**/production/**)|Edit(**/production/**)",
        "hooks": [{
          "type": "command",
          "command": "echo 'WARNING: Attempting to modify production configuration!' && exit 1"
        }]
      }
    ]
  }
}
```

### Lock File Protection

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write(package-lock.json)|Write(yarn.lock)|Write(pnpm-lock.yaml)|Edit(package-lock.json)|Edit(yarn.lock)|Edit(pnpm-lock.yaml)",
        "hooks": [{
          "type": "command",
          "command": "echo 'ERROR: Lock files should be generated by package manager, not edited directly.' && exit 1"
        }]
      }
    ]
  }
}
```

## Logging Hooks

### File Change Log

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [{
          "type": "command",
          "command": "echo \"$(date '+%Y-%m-%d %H:%M:%S') [$CLAUDE_TOOL_NAME] $CLAUDE_FILE_PATHS\" >> .claude/changes.log"
        }]
      }
    ]
  }
}
```

### Session Activity Log

```json
{
  "hooks": {
    "SessionStart": [
      {
        "hooks": [{
          "type": "command",
          "command": "echo \"=== Session started: $(date) ===\" >> .claude/sessions.log"
        }]
      }
    ],
    "SessionEnd": [
      {
        "hooks": [{
          "type": "command",
          "command": "echo \"=== Session ended: $(date) ===\" >> .claude/sessions.log"
        }]
      }
    ]
  }
}
```

## Validation Hooks

### Type Check on Write

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write(*.ts)|Write(*.tsx)|Edit(*.ts)|Edit(*.tsx)",
        "hooks": [{
          "type": "command",
          "command": "npx tsc --noEmit 2>&1 | head -20 || true",
          "timeout": 30000
        }]
      }
    ]
  }
}
```

### Run Tests on Test File Change

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write(*.test.ts)|Write(*.spec.ts)|Edit(*.test.ts)|Edit(*.spec.ts)",
        "hooks": [{
          "type": "command",
          "command": "npm test -- --testPathPattern=\"$CLAUDE_FILE_PATHS\" --passWithNoTests 2>&1 | tail -20 || true",
          "timeout": 60000
        }]
      }
    ]
  }
}
```

## Notification Hooks

### Desktop Notification on Complete

```json
{
  "hooks": {
    "Stop": [
      {
        "hooks": [{
          "type": "command",
          "command": "notify-send 'Claude Code' 'Task completed' 2>/dev/null || osascript -e 'display notification \"Task completed\" with title \"Claude Code\"' 2>/dev/null || true"
        }]
      }
    ]
  }
}
```

### Slack Notification

```json
{
  "hooks": {
    "Stop": [
      {
        "hooks": [{
          "type": "command",
          "command": "curl -X POST -H 'Content-type: application/json' --data '{\"text\":\"Claude Code task completed\"}' $SLACK_WEBHOOK_URL 2>/dev/null || true"
        }]
      }
    ]
  }
}
```

## Git Integration Hooks

### Auto-Stage Changed Files

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [{
          "type": "command",
          "command": "git add \"$CLAUDE_FILE_PATHS\" 2>/dev/null || true"
        }]
      }
    ]
  }
}
```

### Check Branch Before Edit

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [{
          "type": "command",
          "command": "if [ \"$(git branch --show-current)\" = 'main' ] || [ \"$(git branch --show-current)\" = 'master' ]; then echo 'ERROR: Cannot edit files on main/master branch' && exit 1; fi"
        }]
      }
    ]
  }
}
```

## Combined Configurations

### Minimal (Format Only)

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write(*.ts)|Write(*.tsx)|Edit(*.ts)|Edit(*.tsx)",
        "hooks": [{
          "type": "command",
          "command": "prettier --write \"$CLAUDE_FILE_PATHS\""
        }]
      }
    ]
  }
}
```

### Standard (Format + Protect)

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write(*.env*)|Edit(*.env*)",
        "hooks": [{
          "type": "command",
          "command": "echo 'Cannot modify env files' && exit 1"
        }]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write(*.ts)|Write(*.tsx)|Edit(*.ts)|Edit(*.tsx)",
        "hooks": [{
          "type": "command",
          "command": "prettier --write \"$CLAUDE_FILE_PATHS\""
        }]
      },
      {
        "matcher": "Write(*.py)|Edit(*.py)",
        "hooks": [{
          "type": "command",
          "command": "black \"$CLAUDE_FILE_PATHS\""
        }]
      }
    ]
  }
}
```

### Comprehensive

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write(*.env*)|Edit(*.env*)",
        "hooks": [{
          "type": "command",
          "command": "echo 'Cannot modify env files' && exit 1"
        }]
      },
      {
        "matcher": "Write|Edit",
        "hooks": [{
          "type": "command",
          "command": "if [ \"$(git branch --show-current)\" = 'main' ]; then exit 1; fi"
        }]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write(*.ts)|Write(*.tsx)|Edit(*.ts)|Edit(*.tsx)",
        "hooks": [
          {"type": "command", "command": "prettier --write \"$CLAUDE_FILE_PATHS\""},
          {"type": "command", "command": "eslint --fix \"$CLAUDE_FILE_PATHS\""}
        ]
      },
      {
        "matcher": "Write(*.py)|Edit(*.py)",
        "hooks": [
          {"type": "command", "command": "black \"$CLAUDE_FILE_PATHS\""},
          {"type": "command", "command": "ruff check --fix \"$CLAUDE_FILE_PATHS\""}
        ]
      },
      {
        "matcher": "Write|Edit",
        "hooks": [{
          "type": "command",
          "command": "git add \"$CLAUDE_FILE_PATHS\" 2>/dev/null || true"
        }]
      }
    ],
    "SessionStart": [
      {
        "hooks": [{
          "type": "command",
          "command": "echo 'Session started' >> .claude/sessions.log"
        }]
      }
    ]
  }
}
```

## Best Practices

1. **Keep hooks fast** - Long-running hooks slow down Claude
2. **Use timeouts** - Prevent hung processes
3. **Handle errors gracefully** - Use `|| true` for non-critical hooks
4. **Test locally first** - Verify commands work before adding to hooks
5. **Document hooks** - Add comments in related CLAUDE.md
